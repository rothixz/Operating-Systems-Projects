<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>SOFS15: sofs_buffercacheinternals.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SOFS15
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">FUSE based file system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sofs__buffercacheinternals_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sofs_buffercacheinternals.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Set of operations to internally manage the buffercache.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="sofs__buffercachenode_8h_source.html">sofs_buffercachenode.h</a>&quot;</code><br/>
</div>
<p><a href="sofs__buffercacheinternals_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a027ca2187770d3ba51edce5e6f0e6e25"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__buffercacheinternals_8h.html#a027ca2187770d3ba51edce5e6f0e6e25">getFirstNodeOnN</a> (<a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *head)</td></tr>
<tr class="memdesc:a027ca2187770d3ba51edce5e6f0e6e25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access the first node of the double-linked list based on the physical block number of the storage device.  <a href="#a027ca2187770d3ba51edce5e6f0e6e25">More...</a><br/></td></tr>
<tr class="separator:a027ca2187770d3ba51edce5e6f0e6e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b632259b6fb826bc79fddfeb61c2dc8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__buffercacheinternals_8h.html#a6b632259b6fb826bc79fddfeb61c2dc8">getNextNodeOnN</a> (void)</td></tr>
<tr class="memdesc:a6b632259b6fb826bc79fddfeb61c2dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access the next node of the double-linked list based on the physical block number of the storage device.  <a href="#a6b632259b6fb826bc79fddfeb61c2dc8">More...</a><br/></td></tr>
<tr class="separator:a6b632259b6fb826bc79fddfeb61c2dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaab7c046066b03e7c35a5132c38703b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__buffercacheinternals_8h.html#afaab7c046066b03e7c35a5132c38703b">searchNodeOnN</a> (uint32_t nBlock, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *head)</td></tr>
<tr class="memdesc:afaab7c046066b03e7c35a5132c38703b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a given block, whose physical number is given, has already been stored in the storage area.  <a href="#afaab7c046066b03e7c35a5132c38703b">More...</a><br/></td></tr>
<tr class="separator:afaab7c046066b03e7c35a5132c38703b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2f4e8f344585ec504b2d274b0d6093"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__buffercacheinternals_8h.html#aef2f4e8f344585ec504b2d274b0d6093">insertNode</a> (<a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *node, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_nLHead, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_lATLHead, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_lATLTail)</td></tr>
<tr class="memdesc:aef2f4e8f344585ec504b2d274b0d6093"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a node in the two double-linked lists infrastructure.  <a href="#aef2f4e8f344585ec504b2d274b0d6093">More...</a><br/></td></tr>
<tr class="separator:aef2f4e8f344585ec504b2d274b0d6093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab912d39b7cf12c4a5d62a7500bc6fff3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__buffercacheinternals_8h.html#ab912d39b7cf12c4a5d62a7500bc6fff3">retrieveNode</a> (<a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_nLHead, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_lATLHead, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_lATLTail)</td></tr>
<tr class="memdesc:ab912d39b7cf12c4a5d62a7500bc6fff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a node from the two double-linked lists infrastructure.  <a href="#ab912d39b7cf12c4a5d62a7500bc6fff3">More...</a><br/></td></tr>
<tr class="separator:ab912d39b7cf12c4a5d62a7500bc6fff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acdd012b62e852d830a43d7bbffde49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sofs__buffercacheinternals_8h.html#a3acdd012b62e852d830a43d7bbffde49">moveNodeAtHeadLAT</a> (<a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *node, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_lATLHead, <a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **p_lATLTail)</td></tr>
<tr class="memdesc:a3acdd012b62e852d830a43d7bbffde49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the node to the head of the double-linked list based on last access time.  <a href="#a3acdd012b62e852d830a43d7bbffde49">More...</a><br/></td></tr>
<tr class="separator:a3acdd012b62e852d830a43d7bbffde49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Set of operations to internally manage the buffercache. </p>
<p>(interface file)</p>
<p>The buffercache is conceived as two double-linked lists: the first, based on the physical block number of the storage device it is referencing; the second, based on the order of last access to the block. Hence, one needs to define operations to insert, retrieve and access its nodes. One should notice that this module does not stand alone: it supposes a very tight coupling with the buffercache implementation, its only application.</p>
<p>The following operations are defined: </p>
<ul>
<li>access the first node of the double-linked list based on the physical block number of the storage device </li>
<li>access the next node of the double-linked list based on the physical block number of the storage device </li>
<li>check if a given block, whose physical number is given, has already been stored in the storage area </li>
<li>insert a node in the two double-linked lists infrastructure </li>
<li>retrieve a node from the two double-linked lists infrastructure </li>
<li>move a node already present in the storage area to the head of the double-linked list based on the last access time.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>António Rui Borges - July 2010 / August 2011 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a027ca2187770d3ba51edce5e6f0e6e25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a>* getFirstNodeOnN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td>
          <td class="paramname"><em>head</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Access the first node of the double-linked list based on the physical block number of the storage device. </p>
<p>An iterator internal variable is set to the value of the argument and a pointer to the node pointed to by the iterator variable is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">head</td><td>pointer to the head of the linked list based on the physical block number of the storage device</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of the <em>iterator</em> variable </dd></dl>

</div>
</div>
<a class="anchor" id="a6b632259b6fb826bc79fddfeb61c2dc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a>* getNextNodeOnN </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Access the next node of the double-linked list based on the physical block number of the storage device. </p>
<p>The iterator internal variable is iterated if it does not already point to the last node of the linked list, and a pointer to the node pointed to by the iterator variable is returned.</p>
<dl class="section return"><dt>Returns</dt><dd>value of the <em>iterator</em> variable </dd></dl>

</div>
</div>
<a class="anchor" id="aef2f4e8f344585ec504b2d274b0d6093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insertNode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_nLHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_lATLHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_lATLTail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a node in the two double-linked lists infrastructure. </p>
<p>A node whose contents belongs to a block of the storage device, which is supposed not to be stored in the storage area yet, is inserted in the two double-linked lists infrastructure. If the node is already present or the storage area is inconsistent, nothing is done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>pointer to the node to be inserted </td></tr>
    <tr><td class="paramname">p_nLHead</td><td>pointer to a location where the pointer to the head of the double linked list based on the physical block number of the storage device, is stored </td></tr>
    <tr><td class="paramname">p_lATLHead</td><td>pointer to a location where the pointer to the head of the double-linked list based on the last access time, is stored </td></tr>
    <tr><td class="paramname">p_lATLTail</td><td>pointer to a location where the pointer to the tail of the double-linked list based on the last access time, is stored </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3acdd012b62e852d830a43d7bbffde49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void moveNodeAtHeadLAT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_lATLHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_lATLTail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Move the node to the head of the double-linked list based on last access time. </p>
<p>The node which is supposed to have been accessed, is retrieved from its location in the double-linked list based on the last access time and placed at the head of the list. If the node pointer is <code>NULL</code> or the storage area is inconsistent, nothing is done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>pointer to the node to be inserted </td></tr>
    <tr><td class="paramname">p_lATLHead</td><td>pointer to a location where the pointer to the head of the double-linked list based on the last access time, is stored </td></tr>
    <tr><td class="paramname">p_lATLTail</td><td>pointer to a location where the pointer to the tail of the double-linked list based on the last access time, is stored </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab912d39b7cf12c4a5d62a7500bc6fff3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a>* retrieveNode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_nLHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_lATLHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> **&#160;</td>
          <td class="paramname"><em>p_lATLTail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a node from the two double-linked lists infrastructure. </p>
<p>The node which the tail of the double-linked list based on last access time points to, is retrieved from the two double-linked lists infrastructure. If the storage area is inconsistent, nothing is done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_nLHead</td><td>pointer to a location where the pointer to the head of the double linked list based on the physical block number of the storage device, is stored </td></tr>
    <tr><td class="paramname">p_lATLHead</td><td>pointer to a location where the pointer to the head of the double-linked list based on the last access time, is stored </td></tr>
    <tr><td class="paramname">p_lATLTail</td><td>pointer to a location where the pointer to the tail of the double-linked list based on the last access time, is stored</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the retrieved node, or <code>NULL</code> if the storage area is empty or inconsistent </dd></dl>

</div>
</div>
<a class="anchor" id="afaab7c046066b03e7c35a5132c38703b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a>* searchNodeOnN </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sofs__buffercachenode_8h.html#afdd55c5848e1d88ba234bcc6a648f7f7">SOBufferCacheNode</a> *&#160;</td>
          <td class="paramname"><em>head</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a given block, whose physical number is given, has already been stored in the storage area. </p>
<p>The double-linked list based on the physical block number of the storage device is traversed from the node pointed to by the second argument to find out if there is a node whose contents belongs to the block whose physical number is passed as the first argument.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nBlock</td><td>physical block number </td></tr>
    <tr><td class="paramname">head</td><td>pointer to the head of the linked list based on the block number of the storage device</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the node where the block contents is stored, or <code>NULL</code> if the block has not been stored yet </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_490df9f26bda81a79690bb54a35f7831.html">rawIO15</a></li><li class="navelem"><a class="el" href="sofs__buffercacheinternals_8h.html">sofs_buffercacheinternals.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
